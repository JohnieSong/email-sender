# 邮件群发系统

这是一个基于 Python 和 PyQt5 构建的邮件群发系统，支持多种邮箱服务商，提供模板管理、变量替换、附件发送等功能。

## 功能特点

- **多邮箱支持**
  - QQ邮箱
  - 163邮箱
  - QQ企业邮箱
  - Outlook邮箱
  - 自动识别邮箱类型

- **模板管理**
  - HTML格式邮件模板
  - 支持导入导出（.eml、.html、.htm、.mht、.txt、.json）
  - 变量替换功能
  - 实时预览效果

- **收件人管理**
  - Excel文件导入
  - 支持多列变量映射
  - 数据预览和验证

- **附件功能**
  - 支持多个附件
  - 大小限制（单个/总计25MB）
  - 支持常见文件格式（PDF、Word、Excel、PPT、图片、压缩包等）
  - 显示文件大小和总大小

- **发送功能**
  - 实时发送进度
  - 支持中途停止
  - 发送状态记录
  - 错误重试机制
  - 多线程发送

- **其他特性**
  - 发件人昵称设置
  - 测试邮件发送（60秒间隔）
  - 完整的日志记录
  - 现代化界面设计
  - 单实例运行模式

## 安装说明

1. **环境要求**：
   - Python 3.8+
   - PyQt5
   - pandas
   - beautifulsoup4
   - 其他依赖库

2. **安装步骤**：
   ```bash
   # 克隆仓库
   git clone https://github.com/BBRHub/email-sender.git
   
   # 安装依赖
   pip install -r requirements.txt
   
   # 运行程序
   python mail_sender.py
   ```

## 使用指南

### 1. 邮箱配置
- 点击"添加发件人"
- 输入邮箱地址和授权码
- 点击"测试连接"验证配置
- 可选择设置发件人昵称

### 2. 模板管理
- 支持格式：.eml、.html、.htm、.mht、.txt、.json
- 导入方式：
  1. 点击"导入"按钮
  2. 选择模板文件
  3. 输入模板名称
- 导出方式：
  1. 选择要导出的模板
  2. 点击"导出"按钮
  3. 选择导出格式

### 3. 收件人导入
- 支持Excel格式（.xlsx、.xls）
- 可设置变量映射关系
- 支持数据预览和验证

### 4. 附件管理
- 点击"添加附件"选择文件
- 支持删除和预览
- 显示文件大小
- 自动检查大小限制（25MB）

### 5. 发送邮件
- 选择发件人
- 选择模板
- 导入收件人
- 添加附件（可选）
- 点击"发送"开始群发

## 注意事项

1. **附件限制**
   - 单个附件最大 25MB
   - 总大小最大 25MB
   - 支持常见文件格式

2. **发送频率**
   - 测试邮件间隔 60 秒
   - 建议遵循邮件服务商的发送限制

3. **模板导出**
   - 多个模板导出时不支持 .eml 和 .mht 格式
   - JSON 格式保留最完整的信息

## 常见问题

1. **为什么收不到测试邮件？**
   - 检查邮箱配置是否正确
   - 确认是否超过发送间隔（60秒）
   - 查看垃圾邮件文件夹

2. **附件在手机上看不到？**
   - 确保附件格式受支持
   - 检查附件大小是否超限
   - 尝试使用标准格式（如 .zip）

3. **变量替换不生效？**
   - 检查变量名格式（需要用{}包围）
   - 确认Excel中的列名映射正确
   - 预览邮件内容确认变量位置

## 更新日志

请查看 [CHANGELOG.md](CHANGELOG.md) 了解详细的更新历史。

### 使用发布版本

1. 从 [Releases](https://github.com/JohnieSong/email-sender/releases) 页面下载最新版本

## 许可证

本项目采用 MIT 许可证，详情请查看 [LICENSE](LICENSE) 文件。

## 日志文件位置

日志文件存放在程序根目录下的`logs`文件夹中：
- 开发环境：项目根目录/logs/
- 打包环境：程序所在目录/logs/

日志文件按日期命名，格式为：`log-YYYY-MM-DD.log` 

### 查看记录
- 点击"工具 -> 发送历史记录"查看发送历史
- 点击"工具 -> 系统日志"查看系统日志
- 可以导出发送结果和系统日志

## 常见问题

1. **发送失败怎么办？**
   - 检查网络连接
   - 确认邮箱账号和授权码正确
   - 查看系统日志了解详细错误信息

2. **如何获取邮箱授权码？**
   - QQ邮箱：设置 -> 账户 -> POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务
   - 163邮箱：设置 -> POP3/SMTP/IMAP -> 开启服务
   - 具体步骤请参考各邮箱服务商的说明

3. **支持哪些变量？**
   - Excel表格中的所有列名都可以作为变量
   - 使用花括号包裹变量名，如：{姓名}
   - 可以在"工具 -> 变量管理"中查看所有可用变量

## 免责声明

- 本工具仅供学习和研究使用，严禁用于任何商业和非法用途
- 使用本工具时请遵守《中华人民共和国网络安全法》等相关法律法规
- 请勿利用本工具发送垃圾邮件、诈骗邮件或其他违法信息
- 使用本工具所产生的一切法律责任由使用者自行承担
- 本工具为开源项目，不提供任何形式的技术支持和保证

## 联系我们

- 官方网站：[https://blog.bbrhub.com/](https://blog.bbrhub.com/)

- 技术支持邮箱：[support@bbrhub.com](support@bbrhub.com)


